language: minimal

os: linux 

sudo: required

dist: xenial

addons:
  apt:
    sources:
      - debian-sid

env:
  global:
    - APT_GET_OPTIONS: "'--no-install-recommends --allow-unauthenticated --no-upgrade'" 

install:
  - sudo apt-get install $APT_GET_OPTIONS localepurge
  - sudo apt-get install $APT_GET_OPTIONS mame-tools 
  - sudo apt-get install $APT_GET_OPTIONS acme 
  - wget -O ./cadius https://github.com/mach-kernel/cadius/releases/download/1.4.2/cadius-linux
  - chmod +x ./cadius
  - export PATH=$PATH:.

script:
  - make dsk chd

deploy:
  provider: releases
  api_key: $GITHUB_OAUTH_TOKEN
  file: 
    - "build/4cade.2mg"
    - "build/4cade.2mg.chd"
  skip_cleanup: true
  draft: true